# Serial Monitor App 使い方ガイド

## 概要

`serial_monitor_app` は、シリアル通信機器のモニタリング・制御・データ可視化・EEPROM操作・コマンド管理・リアルタイム値表示・CSVログ保存などを行うための、PySide6ベースのクロスプラットフォームGUIアプリケーションです。

---

## 起動方法

1. Python環境がある場合  
   コマンドプロンプトで以下を実行  
   ```
   cd "C:\Users\81804\Documents\0.lab-project\A program of Serial.exe from Mr. Tatsuno in TSC 20250730\serial_monitor_app"
   python main.py
   ```
2. exeファイルがある場合  
   `dist\main.exe` をダブルクリックして起動

---

## 画面構成

- **左パネル**  
  - シリアルポート設定（COMポート/ボーレート/パリティ/接続・切断ボタン）
  - オートラン設定（定期コマンド送信）
  - 送受信欄（手動送信、受信内容表示、クリア）

- **右パネル**  
  - グラフ表示（受信データの可視化）
  - コマンドリスト・EEPROM操作

- **値表示ウィンドウ**  
  - 最大60個の値をリアルタイム表示
  - CSV自動ロギング

---

## 基本操作

### 1. シリアル通信の設定・接続

- COMポート、ボーレート、パリティを選択
- 「Open」ボタンで接続、「Close」ボタンで切断

### 2. コマンド送信・受信

- テキストボックスにコマンドを入力し「Send」ボタンで送信
- 受信内容は下のテキストエリアに表示
- 「Clear」ボタンで受信欄をクリア

### 3. コマンドリスト管理

- 33個までのコマンドをリスト化し、ボタン一つで送信可能
- 「Load from File...」「Save to File...」でコマンドリストの保存・読込

### 4. EEPROM操作

- ROM→ファイル保存、ファイル→ROM書込が可能
- アドレスやファイル名を指定して操作

### 5. グラフ表示

- 受信したメモリデータ（最大4ch×1024点）をグラフで表示
- データ受信時に自動更新

### 6. リアルタイム値表示・CSV保存

- 別ウィンドウで最大60個の値をリアルタイム表示
- 1秒ごとにCSVファイルへ自動保存（ファイル名・保存先指定可）

### 7. オートラン機能

- 任意のコマンドを指定間隔（ms単位）で自動送信可能

---

## 設定ファイル・リソース

- `config/init_load_cmd.txt` … 起動時に読み込むコマンドリスト
- `config/rs20250624B.txt` … EEPROM操作等で利用するデータファイル

---

## 注意事項

- Python 3.8以降、PySide6、pyserial、matplotlib、numpy等のインストールが必要です
- シリアルポートの競合や権限に注意してください
- EEPROM操作やファームウェア書き込みは慎重に行ってください

---

## よくある質問

- **exeファイルが起動しない**  
  → 必要なDLLやリソースファイルが不足している場合があります。`dist`フォルダに必要なファイルをコピーしてください。

- **コマンド送信ができない**  
  → COMポート設定や接続状態を確認してください。

- **グラフが見切れる/見づらい**  
  → 画面サイズを調整するか、`matplotlib_widget.py`の`Figure`サイズを変更してください。

---

## 拡張・カスタマイズ

- コマンド体系やデータ解析ロジックは`utils/data_processor.py`で拡張可能
- UIの追加やレイアウト変更も容易
- 他機器への流用や新機能追加にも柔軟に対応

---

以上が `serial_monitor_app` の主な使い方です。  
ご不明点やカスタマイズ要望があればご相談